# sqlserver索引
## 1.基础概念
* ### [1.1 聚集索引](#11聚集索引-clustering-index)
* ### [1.2 非聚集索引](#12非聚集索引-nonclustering-index)
* ### [1.3 包含列索引](#13-包含列索引-1)
* ### [1.4 筛选索引](#14-筛选索引-1)
## [2.创建索引](#2-创建索引)


## 1. 基础概念

#### 索引
索引是一个单独的，存储在磁盘上的数据结构，它们包含则对数据表里所有记录的引用指针，使用索引用于快速找出在某个或多个列中有某一特定值的行，对相关列使用索引是降低查询操作时间的最佳途径。索引包含由表或视图中的一列或多列生成的键。

但索引所带来的性能好处是有代价的。首先，索引在数据库中会占用一定的存储空间来存储索引部分，其次，在对数据进行插入、更改、删除操作时，为了使索引和数据保持一致，还需要对索引进行相应维护。对索引的维护是需要花费时间的。

因此，利用索引提高查询效率是以空间和增加了数据更改的时间为代价的。在设计和创建索引时，应确保对性能的提高程度大于在存储空间和处理资源方面的代价。

### 1.1聚集索引 clustering index

  聚集索引对数据按索引关键字进行物理排序。

  在SQL Server中 聚集索引和非聚集索引都采用B-树结构来存储索引项，而且都包含数据页和索引页，其中索引页存在索引项和只想下一层的指针，数据页用来存放数据

  建立聚集索引后，数据将按聚集索引关键字的值进行物理排序
  
#### *考虑对具有下列特点的查询使用聚集索引：*

* 使用运算符：between and,>,<,>=,<=返回一个的范围值
* 使用大型结果集的查询
* 经常使用join子句进行连接操作
* 经常使用order by或group by子句
#### *考虑对具有下列特点的列建立聚集索引：*
* 唯一或包含许多不重复的列
* 被顺序访问的列
* order by或group by子句经常指定的列
* 经常被用具进行连接操作的列
#### *在具有下列特点的列上不适合建立聚集索引：*
* 频繁更改的列
* 宽键

### 1.2非聚集索引 nonclustering index
  非聚集索引不对数据进行物理排序
 
  非聚集索引可以建立在有聚集索引的表上，也可以建立在无任何索引的表上，在SQL Server中，非聚集索引中的行定位器有两种形式:

1.  如果该表中没有定义聚集索引，则行定位器就是指向行的指针。
2.  如果该表已建有聚集索引，则定位器就是改行的聚集索引关键字的值。

#### *考虑对具有下列特点的查询使用聚集索引：*

* 不返回大型结果集的查询
* 使用join或group by子句
* 包含大量非重复值的列
* 经常作为查询条件使用的列



### 1.3 包含列索引
  将非索引关键字也放置到非聚集索引叶级的索引成为包含列索引。
  包含列索引本质上是一种非聚集索引，它只是拓展了非聚集索引的叶级，将查询经常涉及的列也放置到叶级索引中

#### *在非聚集索引的叶级增加非索引关键字的好处如下*
* 被包含的列可以是不允许作为索引键列的数据类型
* 在计算索引键列的格数和索引大小时，数据库管理系统不考虑这些非索引键列键列的个数及索引键大小的限制

### 1.4 筛选索引
  筛选索引是一种经过优化的非聚集索引，适用于选择表中部分数据的查询。筛选索引适用筛选谓词对表中的部分数据行进行索引。与对全表建立索引相比，设计良好的筛选索引可以提高查询性能、减少索引维护开销并降低索引存储开销。

#### *筛选索引与权标索引相比具有以下特点:*
1.  提高了查询性能和执行计划质量
2.  减少了索引维护开销
3.  较少了索引存储开销

#### *适合建立筛选索引的情况:*
1.  只需要查询列中少量的相关值时，可以针对值的子集创建筛选索引。
2.  异类数据的筛选索引

#### *以下是适宜建立筛选索引的情况:*
* 金包含少量非NULL值的系数咧
* 包含多种类别数据的异类列
* 包含多个范围值的列
* 由列值的简单比较逻辑定义的表分区

## 2. 创建索引
 [CREATE INDEX (Transact-SQL)](https://msdn.microsoft.com/zh-cn/library/ms188783\(v=sql.105\).aspx)